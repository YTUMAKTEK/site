<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0"/>
<title>Organization Hub</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#fff}
body{font-family:'DM Mono',monospace}
#root{width:100%;height:100%}
::-webkit-scrollbar{display:none}
.ps{overflow-y:auto;scrollbar-width:none}
.ps::-webkit-scrollbar{display:none}
@keyframes popIn{
  0%{opacity:0;transform:scale(0.3)}
  60%{transform:scale(1.08)}
  100%{opacity:1;transform:scale(1)}
}
@keyframes ttFade{
  from{opacity:0;transform:translateX(-50%) translateY(calc(-100% + 8px))}
  to{opacity:1;transform:translateX(-50%) translateY(-100%)}
}
@keyframes panelIn{
  from{transform:translateX(100%)}
  to{transform:translateX(0)}
}
@keyframes panelOut{
  from{transform:translateX(0)}
  to{transform:translateX(100%)}
}
@keyframes contentIn{
  from{opacity:0;transform:translateY(22px)}
  to{opacity:1;transform:translateY(0)}
}
@keyframes heroIn{
  from{opacity:0;transform:scale(0.4)}
  to{opacity:1;transform:scale(1)}
}
@keyframes fadeBack{
  from{opacity:1}
  to{opacity:0.22}
}
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<script>
/* ════════════════════════════════════════════════════════════
   MAKTEK— Interactive Canvas
   Pure React (no Framer Motion CDN needed), custom physics,
   shared-element-style transition, zoom control.
═══════════════════════════════════════════════════════════════ */
const {useState,useEffect,useRef,useCallback,useMemo}=React;

/* ── Palette ─────────────────────────────────────────────── */
const C={bg:'#FFFFFF',navy:'#0C2C47',mauve:'#D6C9C5',yellow:'#DA9B2B',green:'#2E5749',orange:'#BF512C',mint:'#ABCBCA'};
const GROUPS={
  org:    {label:'Organization',color:C.yellow,  text:C.navy},
  general:{label:'General',     color:C.mauve, text:C.navy},
  racing: {label:'Racing',      color:C.navy,text:'#fff'},
  astrid: {label:'Astrid',      color:C.green, text:'#fff'},
  sigma:  {label:'Sigma',       color:C.orange,text:'#fff'},
  rocket: {label:'Rocket',      color:C.mint,  text:C.navy},
};

/* ── Heroicons SVG paths ─────────────────────────────────── */
const P={
  grid:    `<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 018.25 20.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25A2.25 2.25 0 0113.5 8.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"/>`,
  chart:   `<path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/>`,
  calendar:`<path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"/>`,
  trophy:  `<path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0"/>`,
  users:   `<path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/>`,
  mail:    `<path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"/>`,
  phone:   `<path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"/>`,
  heart:   `<path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"/>`,
  star:    `<path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"/>`,
  bolt:    `<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"/>`,
  cog:     `<path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12a7.5 7.5 0 0015 0m-15 0a7.5 7.5 0 1115 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077l1.41-.513m14.095-5.13l1.41-.513M5.106 17.785l1.15-.964m11.49-9.642l1.149-.964M7.501 19.795l.75-1.3m7.5-12.99l.75-1.3m-6.063 16.658l.26-1.477m2.605-14.772l.26-1.477m0 17.726l-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205L12 12m6.894 5.785l-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864l-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"/>`,
  map:     `<path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/>`,
  info:    `<path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"/>`,
  building:`<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"/>`,
  car:     `<path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"/>`,
  rocket:  `<path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>`,
  plane:   `<path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"/>`,
  flag:    `<path stroke-linecap="round" stroke-linejoin="round" d="M3 3v1.5M3 21v-6m0 0l2.77-.693a9 9 0 016.208.682l.108.054a9 9 0 006.086.71l3.114-.732a48.524 48.524 0 01-.005-10.499l-3.11.732a9 9 0 01-6.085-.711l-.108-.054a9 9 0 00-6.208-.682L3 4.5M3 15V4.5"/>`,
  wrench:  `<path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z"/>`,
  beaker:  `<path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0112 15a9.065 9.065 0 00-6.23-.693L5 14.5m14.8.8l1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0112 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"/>`,
};

function SVGIcon({name,size,color}){
  return React.createElement('div',{
    style:{display:'flex',alignItems:'center',justifyContent:'center',pointerEvents:'none',flexShrink:0},
    dangerouslySetInnerHTML:{__html:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="${color||'#fff'}" width="${size}" height="${size}">${P[name]||P.info}</svg>`}
  });
}
// ADD this new function right after SVGIcon:
function ImgIcon({src, size}){
  return React.createElement('img',{
    src: src,
    width: size,
    height: size,
    style:{objectFit:'contain', pointerEvents:'none', flexShrink:0}
  });
}
function FAIcon({name,size,color}){
  return React.createElement('i',{
    className:name,
    style:{fontSize:size*0.75,color:color,pointerEvents:'none',flexShrink:0}
  });
}
/* ── Node Definitions ────────────────────────────────────── */
const RAW=[
  {id:"org-bem",         label:"BEM",                   group:"org",    icon:"chart",    r:46, photo:"photos/bem.jpg",},
  {id:"org-datathon",    label:"Datathon",               group:"org",    icon:"grid",   r:56, photo:"photos/datathon.jpg", fa:"fa-solid fa-code"},
  {id:"org-auto-evo",    label:"Automotive Evolution",   group:"org",    icon:"grid",     r:64, photo:"photos/otomobilinevrimi.jpg",  fa:"fa-solid fa-car"},
  {id:"org-defense",     label:"Defense Industry Days",  group:"org",    icon:"grid",    r:50, photo:"photos/ssg.jpg", fa:"fa-solid fa-industry"},
  {id:"org-ces",         label:"CES",                    group:"org",    icon:"bolt",    r:42},
  {id:"org-tubitak",     label:"TUBITAK Projects",       group:"org",    icon:"beaker",  r:54},
  {id:"org-members",     label:"Org Members",            group:"org",    icon:"users",   r:48, photo:"photos/maktekorg.jpg",},
  {id:"org-sponsors",    label:"Sponsor List",           group:"org",    icon:"star",    r:44},
  {id:"org-side",        label:"Side Projects",          group:"org",    icon:"wrench",  r:46},
  {id:"org-schema",      label:"Org Schema",             group:"org",    icon:"grid",r:60, photo:"photos/orgschema.jpg", fa:"fa-solid fa-list"},
  {id:"gen-vision",      label:"Vision & Mission",       group:"general",img:"icons/mak-tek.png",    r:62, iconScale:1.4, panelIconScale:1.7, photo:"photos/vizyonmisyon.jpg",},
  {id:"gen-members",       label:"Board Members",          group:"general",icon:"users",   r:52},
  {id:"gen-ins",    label:"Responsible Instructors",group:"general",icon:"grid",    r:46, photo:"photos/hoca.jpeg", fa:"fa-solid fa-graduation-cap"},
  {id:"gen-contact",     label:"Contact Us",             group:"general",icon:"phone",   r:44},
  {id:"gen-comm",        label:"Communication",          group:"general",icon:"mail",    r:50},
  {id:"gen-thanks",      label:"Thank You",              group:"general",icon:"heart",   r:42},
  {id:"racing-members",  label:"Racing Members",         group:"racing", icon:"users",   r:52, photo:"photos/racingmembers.jpg",},
  {id:"racing-project", label:"Racing Project", group:"racing", img:"icons/racing.png", r:66, iconScale:1.7, panelIconScale:1.7, photo:"photos/racingproject.jpg",},
  {id:"racing-sponsors", label:"Racing Sponsors",        group:"racing", icon:"star",    r:44,photo:"photos/racingsponsor.jpg",},
  {id:"racing-contact",  label:"Racing Contact",         group:"racing", icon:"phone",    r:46,photo:"photos/racingcontact.jpg",},
  {id:"racing-org",      label:"Racing Org",             group:"racing", icon:"grid",r:50,photo:"photos/racingorg.jpg", fa:"fa-solid fa-list"},
  {id:"racing-history",  label:"Racing History",         group:"racing", icon:"trophy",  r:48,photo:"photos/racinghistory.jpg",},
  {id:"astrid-members",  label:"Astrid Members",         group:"astrid", icon:"users",   r:50, photo:"photos/astridmembers.jpg",},
  {id:"astrid-project",  label:"Astrid Project",         group:"astrid", img:"icons/astrid.png",   r:68, iconScale:1.7, panelIconScale:1.7, photo:"photos/astridproject.jpg",},
  {id:"astrid-sponsors", label:"Astrid Sponsors",        group:"astrid", icon:"star",    r:42,photo:"photos/astridsponsor.jpg",},
  {id:"astrid-contact",  label:"Astrid Contact",         group:"astrid", icon:"phone",   r:44,photo:"photos/astridcontact.jpg",},
  {id:"astrid-org",      label:"Astrid Org",             group:"astrid", icon:"grid",     r:52,photo:"photos/astridorg.jpg", fa:"fa-solid fa-list"},
  {id:"astrid-history",  label:"Astrid History",         group:"astrid", icon:"trophy",r:48, photo:"photos/astridhistory.jpg",},
  {id:"sigma-members",   label:"Sigma Members",          group:"sigma",  icon:"users",   r:48, photo:"photos/sigmamembers.jpg"},
  {id:"sigma-project",   label:"Sigma Project",          group:"sigma",  img:"icons/sigma.png",    r:66, iconScale:1.7, photo:"photos/sigmaproject.jpg", panelIconScale:1.7},
  {id:"sigma-sponsors",  label:"Sigma Sponsors",         group:"sigma",  icon:"star",    r:44, photo:"photos/sigmasponsor.jpg",},
  {id:"sigma-contact",   label:"Sigma Contact",          group:"sigma", icon:"phone",    r:46, photo:"photos/sigmacontact.jpg",},
  {id:"sigma-org",       label:"Sigma Org",              group:"sigma",  icon:"grid",r:50, photo:"photos/sigmaorg.jpg", fa:"fa-solid fa-list"},
  {id:"sigma-history",   label:"Sigma History",          group:"sigma",  icon:"trophy",  r:52, photo:"photos/sigmahistory.jpg",},
  {id:"rocket-members",  label:"Rocket Members",         group:"rocket", icon:"users",   r:48, photo:"photos/rokethistory.jpg",},
  {id:"rocket-project",  label:"Rocket Project",         group:"rocket", img:"icons/roket.png",   r:50, iconScale:1.7, panelIconScale:1.7, photo:"photos/roketproject.jpg",},
  {id:"rocket-sponsors", label:"Rocket Sponsors",        group:"rocket", icon:"star",    r:44, photo:"photos/roketsponsor.jpg",},
  {id:"rocket-contact",  label:"Rocket Contact",         group:"rocket", icon:"phone",    r:46,photo:"photos/roketcontact.jpg",},
  {id:"rocket-org",      label:"Rocket Org",             group:"rocket", icon:"grid",     r:52,photo:"photos/roketorg.jpg", fa:"fa-solid fa-list"},
  {id:"rocket-history",  label:"Rocket History",         group:"rocket", icon:"trophy",r:48,photo:"photos/rokethistory.jpg",},
];

/* ── Force-directed layout (pure JS) ────────────────────── */
function runSim(nodes,W,H){
  // ↑ CHANGE 1: pad 22→55 for airy, breathable spacing
  const pad=55;
  const seed=nodes.map((n,i)=>({
    ...n,
    // wider initial spread so sim converges faster to spread state
    x:W/2+(Math.cos(i/nodes.length*Math.PI*2))*W*0.38 + (Math.random()-0.5)*200,
    y:H/2+(Math.sin(i/nodes.length*Math.PI*2))*H*0.38 + (Math.random()-0.5)*160,
    vx:0,vy:0,
  }));

  for(let t=0;t<500;t++){
    const alpha=Math.pow(1-t/500,1.4);

    // Softer center gravity so nodes stay spread
    for(const n of seed){
      n.vx+=(W/2-n.x)*0.003*alpha;
      n.vy+=(H/2-n.y)*0.003*alpha;
    }

    // Collision repulsion — stronger force (0.6→0.85)
    for(let i=0;i<seed.length;i++){
      for(let j=i+1;j<seed.length;j++){
        const a=seed[i],b=seed[j];
        const dx=b.x-a.x, dy=b.y-a.y;
        const dist=Math.sqrt(dx*dx+dy*dy)||0.001;
        const minD=a.r+b.r+pad;
        if(dist<minD){
          const f=((minD-dist)/dist)*0.85*alpha;
          a.vx-=dx*f; a.vy-=dy*f;
          b.vx+=dx*f; b.vy+=dy*f;
        }
        // Extra soft repulsion for nearby circles (not touching but too close)
        else if(dist<minD*1.6){
          const f=0.04*alpha*(1-(dist-minD)/(minD*0.6));
          a.vx-=dx*f; a.vy-=dy*f;
          b.vx+=dx*f; b.vy+=dy*f;
        }
      }
    }

    // Integrate — more damping for stability
    for(const n of seed){
      n.vx*=0.45; n.vy*=0.45;
      n.x+=n.vx; n.y+=n.vy;
      n.x=Math.max(n.r+36,Math.min(W-n.r-36,n.x));
      n.y=Math.max(n.r+90,Math.min(H-n.r-36,n.y));
    }
  }
  return seed;
}

/* ── Floats ─────────────────────────────────────────────── */
const FL=[
  {ax:3,ay:7,dx:0.8,dy:1.1},
  {ax:5,ay:5,dx:1.3,dy:0.7},
  {ax:4,ay:8,dx:0.6,dy:1.4},
  {ax:6,ay:4,dx:1.1,dy:0.9},
  {ax:2,ay:9,dx:0.9,dy:1.2},
];

/* ══════════════════════════════════════════════════════════
   NODE CIRCLE COMPONENT
══════════════════════════════════════════════════════════ */
function NodeCircle({node,g,idx,selected,hovered,setHovered,setSelected}){
  const elRef=useRef(null);
  const animState=useRef({ox:node.x,oy:node.y,phase:Math.random()*Math.PI*2,entered:false,enterProg:0,raf:null});
  const fl=FL[idx%FL.length];
  const isSel=selected?.id===node.id;
  const hasSel=!!selected;
  const isHov=hovered===node.id;

  useEffect(()=>{
    const el=elRef.current;
    if(!el)return;
    let raf;
    let startTime=null;
    const delay=idx*25;

    const animate=(ts)=>{
      if(!startTime)startTime=ts;
      const elapsed=ts-startTime-delay;

      if(elapsed<0){ raf=requestAnimationFrame(animate); return; }

      // Float offset
      const t=elapsed/1000;
      const phase=animState.current.phase;
      const ox=Math.sin(t*fl.dx+phase)*fl.ax;
      const oy=Math.cos(t*fl.dy+phase*1.3)*fl.ay;

      // Entrance pop (0→1 over 600ms with overshoot)
      const entProg=Math.min(elapsed/600,1);
      const entScale=entProg<1
        ? 0.3+Math.sin(entProg*Math.PI)*0.85
        : 1;
      const entOp=Math.min(elapsed/300,1);

      animState.current.ox=ox;
      animState.current.oy=oy;

      const finalX=node.x-node.r+ox;
      const finalY=node.y-node.r+oy;

      if(el){
        el.style.left=finalX+'px';
        el.style.top=finalY+'px';
        el.style.opacity=`${entOp * (hasSel && !isSel ? 0.22 : 1)}`;
        const hoverScale=isHov&&!hasSel?1.11:1;
        const selScale=isSel?0:hasSel?0.82:1;
        el.style.transform=`scale(${Math.min(entScale,1)*selScale*hoverScale})`;
      }

      raf=requestAnimationFrame(animate);
    };

    raf=requestAnimationFrame(animate);
    return()=>cancelAnimationFrame(raf);
  },[node.x,node.y,node.r,isSel,hasSel,isHov,idx,fl]);

  const iconSz=Math.round(node.r*(node.iconScale||0.52));

  return React.createElement('div',{
    ref:elRef,
    onMouseEnter:()=>{ if(!hasSel)setHovered(node.id); },
    onMouseLeave:()=>setHovered(null),
    onClick:()=>{ if(!hasSel){ setSelected(node); setHovered(null); } },
    style:{
      position:'absolute',
      width:node.r*2,
      height:node.r*2,
      borderRadius:'50%',
      background:g.color,
      display:'flex',
      alignItems:'center',
      justifyContent:'center',
      cursor:hasSel?'default':'pointer',
      boxShadow:isHov&&!hasSel
        ?`0 20px 55px -12px ${g.color}88`
        :`0 4px 22px rgba(0,0,0,0.09)`,
      transition:'box-shadow 0.3s ease, opacity 0.45s ease, transform 0.4s cubic-bezier(0.34,1.56,0.64,1)',
      willChange:'transform,opacity,left,top',
      userSelect:'none',
    }
  },
  node.fa
  ? React.createElement(FAIcon,{name:node.fa,size:iconSz,color:g.text})
  : node.img
    ? React.createElement(ImgIcon,{src:node.img,size:iconSz})
    : React.createElement(SVGIcon,{name:node.icon,size:iconSz,color:g.text})
  );
}

/* ══════════════════════════════════════════════════════════
   TOOLTIP (fixed pos, avoids zoom)
══════════════════════════════════════════════════════════ */
function Tooltip({node,nodes,zoom,shiftX}){
  if(!node)return null;
  const n=nodes.find(nd=>nd.id===node);
  if(!n)return null;

  const W=window.innerWidth, H=window.innerHeight;
  // screen coords of circle top-center
  const sx = (n.x - W/2)*zoom + W/2 + shiftX;
  const sy = (n.y - n.r - H/2)*zoom + H/2 - 10;

  return React.createElement('div',{
    key:node,
    style:{
      position:'fixed',
      left:sx,
      top:sy,
      transform:'translateX(-50%) translateY(-100%)',
      background:C.navy,
      color:'#fff',
      fontFamily:"'DM Mono',monospace",
      fontSize:'0.57rem',
      letterSpacing:'0.14em',
      textTransform:'uppercase',
      whiteSpace:'nowrap',
      padding:'5px 12px',
      borderRadius:3,
      pointerEvents:'none',
      zIndex:9999,
      animation:'ttFade 0.15s ease forwards',
    }
  },
    n.label,
    React.createElement('div',{style:{
      position:'absolute',top:'100%',left:'50%',
      transform:'translateX(-50%)',
      border:'5px solid transparent',
      borderTopColor:C.navy,
    }})
  );
}

/* ══════════════════════════════════════════════════════════
   MEMBERS DATA — per bubble id
══════════════════════════════════════════════════════════ */
const MEMBERS_DATA={
  "org-members":[
    {name:"Zeynep Topuz",    url:"https://linkedin.com/in/ahmet-yilmaz"},
    {name:"Dilara Yavuz",      url:"https://linkedin.com/in/ayse-demir"},
    {name:"Tunç Korkmazer",     url:"https://linkedin.com/in/mehmet-kaya"},
    {name:"Atakan Yıldırım",   url:"https://linkedin.com/in/zeynep-arslan"},
  ],
  "gen-members":[
    {name:"Arda Devrim",    url:"https://linkedin.com/in/ahmet-yilmaz"},
    {name:"Faruk Cem Kaleli",      url:"https://linkedin.com/in/ayse-demir"},
    {name:"Melike Şengelen",     url:"https://linkedin.com/in/mehmet-kaya"},
    {name:"Merve İrem Özdemir",   url:"https://linkedin.com/in/zeynep-arslan"},
  ],
  "gen-ins":[
    {name:"Prof. Özden Ağra",   url:"mailto:ali.celik@university.edu"},
    {name:"Doç. Alptekin Ergenç",   url:"mailto:fatma.kurt@university.edu"},
  ],
  "racing-members":[
    {name:"Cem Aygün",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Buse Koyunoğlu",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Ahmet Bağcı",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Alp Ömer Didici",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Osman Güneş",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Rafi Purtaş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Erdem Çabuker",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Özgür Can Şenol",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Toygar Hilmi Öztürk",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Melike Dündar",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Bedirhan Ayhan",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Mehmet Emir Öztaş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Kadir Bağcı",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Kerem Bayındır",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Özgür Deniz Özer",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Erim Eyigüngör",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Ahmet Sertkaya",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"İsmail Akbaş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Burak Salih Yılmaz",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Bedirhan N. Yavaş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Yiğit Ersan Kantarcı",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Ayşenur Özdemir",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Kaan Özsoy",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Emir Baran Çelik",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Serra Vardar",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Ata Dinçer",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Elif Ece Doğan",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Osman Emir Keçeci",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Nurlan Rahimov",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Bedirhan Can",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Metehan Dalkıran",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Bedirhan Akpınar",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Berke Çırak",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Göktuğ Gada",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Kazım Sancar Efe",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Oğuzhan Avcı",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Buğra Emin  Atan",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Sultan Berre Güngör",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"İkra Azra Pişirici",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Sueda Zeynep Demirtaş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Çağan Yağız",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Mahir Kemal Çavdat",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Emirhan Özdemir",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"Yiğit Kadeş",    url:"https://linkedin.com/in/selin-yildiz"},
    {name:"Bora Akaner",      url:"https://linkedin.com/in/berk-dogan"},
    {name:"İbrahim Efe Odabaşı",    url:"https://linkedin.com/in/selin-yildiz"},
],
  "astrid-members":[
    {name:"Devrim",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Emirhan Günay",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Can Buğra Tezcan",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Elifgül Eyigün",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Mehmet Kaan Çakas",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Muhammed Fatih Özgür",   url:"https://linkedin.com/in/kaan-demirbas"},
    {name:"Ebrar Serim",   url:"https://linkedin.com/in/kaan-demirbas"},
    
  ],
  "sigma-members":[
    {name:"Haydar Enes Karaçobanım",    url:"https://linkedin.com/in/tugba-yilmaz"},
    {name:"Erdem Dalbak",       url:"https://linkedin.com/in/alper-sen"},
    {name:"Beyza Şenol",     url:"https://linkedin.com/in/merve-kocak"},
    {name:"Kerem Avcı",     url:"https://linkedin.com/in/tarik-ozkan"},
    {name:"Bilal Eryiğit",     url:"https://linkedin.com/in/busra-gunes"},
    {name:"Erce Yörükoğlu",    url:"https://linkedin.com/in/tugba-yilmaz"},
    {name:"Doğukan Kılıç",       url:"https://linkedin.com/in/alper-sen"},
    {name:"Ahmet Eren Altın",     url:"https://linkedin.com/in/merve-kocak"},
    {name:"Oğuzhan Öksüz",     url:"https://linkedin.com/in/tarik-ozkan"},
    {name:"Emirhan Bulut",     url:"https://linkedin.com/in/busra-gunes"},
    {name:"Yusuf İslam Sağdıç",    url:"https://linkedin.com/in/tugba-yilmaz"},
    {name:"Semranur Civan",       url:"https://linkedin.com/in/alper-sen"},
    {name:"Hafize Feyza Çelebi",     url:"https://linkedin.com/in/merve-kocak"},
    {name:"Özge Uzunharman",     url:"https://linkedin.com/in/tarik-ozkan"},
    {name:"Rukiye Esma Özdemir",     url:"https://linkedin.com/in/busra-gunes"},
    {name:"Can Akkaya",    url:"https://linkedin.com/in/tugba-yilmaz"},
    {name:"Gökçehan Gökçe",       url:"https://linkedin.com/in/alper-sen"},
    {name:"Serdar Topuz",     url:"https://linkedin.com/in/merve-kocak"},
    {name:"Alperen Tatlı",     url:"https://linkedin.com/in/tarik-ozkan"},
    {name:"Mehmet Ali Ildırar",     url:"https://linkedin.com/in/busra-gunes"},
    {name:"Dilara Gülen",    url:"https://linkedin.com/in/tugba-yilmaz"},
    {name:"Elif Rana Tüzün",       url:"https://linkedin.com/in/alper-sen"},
    {name:"Ali Berk Filiz",     url:"https://linkedin.com/in/merve-kocak"},
    {name:"Ceren Hacıoğlu",     url:"https://linkedin.com/in/tarik-ozkan"},
  ],
  "rocket-members":[
    {name:"Abdülmecit Kabasakal",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Nurmuhammet Kayagil",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Ali Yağız Uz",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Mert Şelik",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Sudegül Bekmezci",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Mehmet Ali Duran",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Gökdeniz Yıldırım",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Tayyip Arican",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Melisa Zehiroğlu",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Yiğit Kağan Meriç",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Yusuf Çevik",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Salim Camcı",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Abdullah Mert Genç",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Mervenur Acar",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Ozan Daldaban",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Elif Sevda Nur Dumru",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Sueda Bekmezci",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Işıl Altınbay",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Ahmet Yusuf Özbey",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Ata Oğul Karan",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Gülsüm Yazıcı",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Berke Umut Şahintürk",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Abdullah Enes Kayaalp",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Furkan Uyar",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Emir Han Avcı",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Fırat Aydın",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Yusuf Karaman",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Sude İpek",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Nazlı Hilal İletmiş",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Muhammet Yiğit Yılmaz",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Tuğba Can",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Fatıma Tüz Zehra Turgut",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"İlyas Dilben",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Ömer Faruk Yaman",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Emirhan Yusuf Özçelik",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Ayşe Betül Yılmaz",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"İlke Yatmaz",     url:"https://linkedin.com/in/serdar-avci"},
    {name:"Zeynep Öztürk",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Efe Kağan Önem",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Alp Bora Görüşken",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Elif Doğan",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Abdullah Cumhur",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Batuhan Baş",       url:"https://linkedin.com/in/ece-yaman"},
    {name:"Eren Balcı",    url:"https://linkedin.com/in/ugur-bozkurt"},
    {name:"Namık Hisar",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Emir Han Bulut",     url:"https://linkedin.com/in/baris-erdem"},
    {name:"Ömer Faruk Ekim",       url:"https://linkedin.com/in/gizem-tan"},
    {name:"Dilara Araci",    url:"https://linkedin.com/in/seda-karahan"},
    {name:"Ulaş Kayra Sarı",     url:"https://linkedin.com/in/baris-erdem"},
  ],
};

function isMemberBubble(id){
  return id&&(id.includes('members')||id.includes('active-members')||MEMBERS_DATA[id]!==undefined);
};

/* ══════════════════════════════════════════════════════════
   DETAIL PANEL
══════════════════════════════════════════════════════════ */
const CONTENT = {
  "org-bem":        "BEM is our core engineering methodology. We follow structured component-based design across all projects.",

  "org-datathon":   "Our annual datathon brings together students to solve real-world problems using data science.",

  "gen-vision":     "We aim to become Turkey's leading student engineering community, bridging academia and industry.",

  "gen-comm":       "Reach out to us through this form or follow our social media channels for updates.",

  "racing-project": "The racing car is designed and built entirely by our team. Currently competing in Formula Student.",
  
  "racing-members": ["YTU Racing üyeleri; Makine, Elektrik-Elektronik, Kontrol-Otomasyon, Mekatronik, Elektronik-Haberleşme ve Metalurji-Malzeme mühendisliği öğrencilerinden oluşan yaklaşık 35 kişilik multidisipliner bir ekipten meydana gelmektedir.",  
  "Takım bünyesinde Araç Dinamiği, Powertrain, E-Powertrain, Aerodinamik, Kompozit, Otonom ve Organizasyon departmanları bulunmaktadır. Her üye kendi uzmanlık alanında çalışarak yarış aracının tasarım, üretim, test ve yarış süreçlerine doğrudan katkı sağlar.",
  "Üyelerimiz yalnızca teknik geliştirmelerde değil; aynı zamanda sponsorluk ilişkileri, proje yönetimi ve organizasyon faaliyetlerinde de aktif rol almaktadır.",
],
  "astrid-project": "Astrid is our autonomous drone project. It uses computer vision for obstacle avoidance.",
  "sigma-project":  "Sigma is our underwater vehicle project. Built for the MATE ROV competition.",
  "rocket-members": "Yıldız Roket Takımı üyeleri; Makine, Elektrik-Elektronik, Havacılık, Kontrol-Otomasyon, Bilgisayar, Kimya ve Metalurji-Malzeme mühendisliği başta olmak üzere farklı disiplinlerden oluşmaktadır. Takım bünyesinde Yapısal, Aviyonik, İtki ve Organizasyon departmanlarında aktif görev alan öğrenciler yer almaktadır. Her üye kendi uzmanlık alanında çalışarak roketin tasarım, üretim, test ve uçuş süreçlerine doğrudan katkı sağlar. Üyelerimiz yalnızca teknik çalışmalarda değil; aynı zamanda proje yönetimi, sponsorluk görüşmeleri ve organizasyon faaliyetlerinde de aktif rol almaktadır.",
  "rocket-project": ["Yıldız Roket Takımı projeleri; yüksek güçlü roket sistemleri, faydalı yük entegrasyonu, hibrit roket motorları ve aktif kontrollü uçuş teknolojileri üzerine yoğunlaşmaktadır.",
  " Ana projelerimiz ARTAM yüksek güç roket serisi ve DEMİRKAZIK hibrit roket motoru hattıdır.",
  " ARTAM-I roketi yaklaşık 7 km irtifa, 1.65 Mach maksimum hız ve 550 m/s üzeri tepe hızına ulaşacak şekilde tasarlanmıştır. Proje kapsamında aerodinamik analizler, yapısal optimizasyon, kurtarma sistemleri ve aviyonik haberleşme altyapısı entegre biçimde geliştirilmektedir.",
  " DEMİRKAZIK projesi ise parafin bazlı yakıt ve N₂O oksitleyici kullanan hibrit motor mimarisi üzerine odaklanmaktadır."],
  "rocket-sponsor": "Projelerimiz; üniversite, sanayi ve bireysel destekçilerimizin katkılarıyla hayata geçirilmektedir . Sponsorlarımız üretim süreçleri, malzeme temini, test altyapısı ve lojistik destek konularında takımımıza önemli katkılar sağlamaktadır. Yeni iş birliklerine ve teknik sponsorluklara her zaman açığız.",
  "rocket-history": ["2017 – Takımın kuruluşu",  
"2018 – İlk uçuş denemesi ve sistem iyileştirmeleri  ",
"2019 – Teknofest yarışmalarında derece  ",
"2020 – İlk hibrit motor ateşlemesi  ",
"2021 – Yeniden kullanılabilir roket geliştirme  ",
"2022 – İlk başarılı uçuş  ",
"2023 – ARTAM ve DEMİRKAZIK projelerinin tamamlanması  ",
"2024 – Hibrit motorlu roket ile Teknofest finali  ",

"Bu süreç boyunca takım; aerodinamik, itki, aviyonik ve kurtarma sistemlerinde sürekli gelişim göstermiştir.",

"Bugün Rocket ekibi aktif kontrollü uçuş ve hibrit motor teknolojileri üzerine çalışmalarını sürdürmektedir.",],

};
function Panel({node,panelW,onBack}){
  const g=GROUPS[node.group];
  const bigR=Math.min(80,node.r*1.3);
  const panelRef=useRef(null);
  const [hovMember,setHovMember]=useState(null);
  const [form,setForm]=useState({name:'',email:'',message:''});
  const [sent,setSent]=useState(false);
  const [sending,setSending]=useState(false);
  const [formErr,setFormErr]=useState('');
  const isContact=node.id==='gen-comm';

  const handleSend=()=>{
    if(!form.name||!form.email||!form.message){
      setFormErr('Please fill in all fields.');
      return;
    }
    setFormErr('');
    setSending(true);
    // Replace these three values with your EmailJS credentials:
    emailjs.send(
      'YOUR_SERVICE_ID',
      'YOUR_TEMPLATE_ID',
      { from_name:form.name, from_email:form.email, message:form.message },
      'YOUR_PUBLIC_KEY'
    )
    .then(()=>{
      setSending(false);
      setSent(true);
      setTimeout(()=>{ setSent(false); setForm({name:'',email:'',message:''}); },3500);
    })
    .catch(()=>{
      setSending(false);
      setFormErr('Failed to send. Please try again.');
    });
  };

  // Slide in
  useEffect(()=>{
    const el=panelRef.current;
    if(!el)return;
    el.style.transform='translateX(100%)';
    requestAnimationFrame(()=>{
      requestAnimationFrame(()=>{
        el.style.transform='translateX(0)';
      });
    });
  },[]);

  const handleBack=()=>{
    const el=panelRef.current;
    if(el){
      el.style.transform='translateX(100%)';
      setTimeout(onBack,480);
    } else onBack();
  };

  const isMember=isMemberBubble(node.id);
  const memberList=MEMBERS_DATA[node.id]||[];

  return React.createElement('div',{
    ref:panelRef,
    style:{
      position:'fixed',top:0,right:0,
      width:panelW,height:'100vh',
      background:'#fff',
      boxShadow:'-24px 0 80px rgba(0,0,0,0.14)',
      display:'flex',flexDirection:'column',
      zIndex:400,
      transition:'transform 0.52s cubic-bezier(0.22,1,0.36,1)',
      willChange:'transform',
    }
  },
    // Back btn
    React.createElement('button',{
      onClick:handleBack,
      style:{
        position:'absolute',top:26,left:24,
        background:'none',border:'none',cursor:'pointer',
        display:'flex',alignItems:'center',gap:8,
        fontFamily:"'DM Mono',monospace",
        fontSize:'0.58rem',letterSpacing:'0.2em',textTransform:'uppercase',
        color:C.navy,opacity:0.5,padding:0,
        transition:'opacity 0.2s',
        zIndex:10,
      },
      onMouseEnter:e=>e.currentTarget.style.opacity=1,
      onMouseLeave:e=>e.currentTarget.style.opacity=0.5,
    },
      React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",width:14,height:14},
        React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})
      ),
      'Back'
    ),

    // Scrollable body
    React.createElement('div',{
      className:'ps',
      style:{flex:1,overflowY:'scroll',display:'flex',flexDirection:'column',
  alignItems:'center',padding:'80px 40px 60px',gap:0,
  scrollbarWidth:'thin',
  scrollbarColor:`#D4CEC9 transparent`,}
    },

      /* ① LARGE ICON at top */
      React.createElement('div',{
        style:{
          width:bigR*2,height:bigR*2,borderRadius:'50%',
          background:g.color,
          display:'flex',alignItems:'center',justifyContent:'center',
          boxShadow:`0 22px 60px -16px ${g.color}99`,
          flexShrink:0,
          animation:'heroIn 0.5s cubic-bezier(0.34,1.56,0.64,1) 0.06s both',
        }
      },
      node.fa
  ? React.createElement(FAIcon,{name:node.fa,size:Math.round(bigR*(node.panelIconScale||0.52)),color:g.text})
  : node.img
    ? React.createElement(ImgIcon,{src:node.img,size:Math.round(bigR*(node.panelIconScale||0.52))})
    : React.createElement(SVGIcon,{name:node.icon,size:Math.round(bigR*(node.panelIconScale||0.52)),color:g.text})
  ),
      /* ② TITLE block */
      React.createElement('div',{style:{width:'100%',marginTop:28,animation:'contentIn 0.5s ease 0.18s both'}},
        React.createElement('div',{style:{
          display:'inline-block',padding:'4px 10px',borderRadius:2,
          background:g.color,color:g.text,
          fontFamily:"'DM Mono',monospace",fontSize:'0.52rem',
          letterSpacing:'0.22em',textTransform:'uppercase',marginBottom:14,
        }},g.label),

        React.createElement('h1',{style:{
          fontFamily:"'DM Serif Display',serif",
          fontSize:'clamp(1.5rem,3vw,2.2rem)',
          color:C.navy,lineHeight:1.08,marginBottom:16,
        }},node.label),

        React.createElement('div',{style:{width:36,height:3,background:g.color,borderRadius:2,marginBottom:24}}),
      ),

      /* ③ IMAGE PLACEHOLDER */
      node.photo
  ? React.createElement('img',{
      src: node.photo,
      alt: node.label,
      style:{
        width:'100%',
        aspectRatio:'16/9',
        objectFit:'cover',
        borderRadius:6,
        flexShrink:0,
        animation:'contentIn 0.5s ease 0.26s both',
        display:'block',
      }
    })
  : React.createElement('div',{
      style:{
        width:'100%',
        aspectRatio:'16/9',
        background:'#F0EDEB',
        borderRadius:6,
        display:'flex',flexDirection:'column',
        alignItems:'center',justifyContent:'center',
        gap:10,
        flexShrink:0,
        animation:'contentIn 0.5s ease 0.26s both',
        border:'1.5px dashed #D4CEC9',
        overflow:'hidden',
        position:'relative',
      }
    },
      React.createElement('div',{style:{position:'absolute',top:10,left:10,width:18,height:18,borderTop:`2px solid ${g.color}`,borderLeft:`2px solid ${g.color}`}}),
      React.createElement('div',{style:{position:'absolute',top:10,right:10,width:18,height:18,borderTop:`2px solid ${g.color}`,borderRight:`2px solid ${g.color}`}}),
      React.createElement('div',{style:{position:'absolute',bottom:10,left:10,width:18,height:18,borderBottom:`2px solid ${g.color}`,borderLeft:`2px solid ${g.color}`}}),
      React.createElement('div',{style:{position:'absolute',bottom:10,right:10,width:18,height:18,borderBottom:`2px solid ${g.color}`,borderRight:`2px solid ${g.color}`}}),
      React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"#C5BDB8",width:36,height:36},
        React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})
      ),
      React.createElement('span',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.55rem',letterSpacing:'0.18em',textTransform:'uppercase',color:'#B8B0AB'}},'Image Placeholder'),
    ),
      
      /* ④ TEXT CONTENT */
      React.createElement('div',{style:{width:'100%',marginTop:24,animation:'contentIn 0.5s ease 0.32s both'}},
      React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:12}},
  (Array.isArray(CONTENT[node.id])
    ? CONTENT[node.id]
    : [CONTENT[node.id] || `This section covers everything related to ${node.label}.`]
  ).map((para,i)=>
    React.createElement('p',{key:i,style:{
      fontFamily:"'DM Mono',monospace",fontSize:'0.76rem',
      lineHeight:1.9,color:C.navy,opacity:0.6,
    }},para)
  )
),
      ),

      /* ⑤ MEMBERS LIST — only for member bubbles */
      isMember && React.createElement('div',{
        style:{width:'100%',marginTop:28,animation:'contentIn 0.5s ease 0.38s both'}
      },
        React.createElement('p',{style:{
          fontFamily:"'DM Mono',monospace",fontSize:'0.52rem',
          letterSpacing:'0.22em',textTransform:'uppercase',
          color:C.navy,opacity:0.38,marginBottom:14,
          paddingBottom:8,borderBottom:'1px solid #EDE8E5',
        }},'Members'),

        memberList.length>0
          ? React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:0}},
              memberList.map((m,mi)=>
                React.createElement('a',{
                  key:mi,
                  href:m.url,
                  target:'_blank',
                  rel:'noopener noreferrer',
                  onMouseEnter:e=>{ setHovMember(mi); e.currentTarget.style.paddingLeft='14px'; e.currentTarget.style.color=g.color; },
                  onMouseLeave:e=>{ setHovMember(null); e.currentTarget.style.paddingLeft='0'; e.currentTarget.style.color=C.navy; },
                  style:{
                    display:'flex',alignItems:'center',gap:10,
                    padding:'11px 0',
                    borderBottom:'1px solid #F2EDEA',
                    fontFamily:"'DM Mono',monospace",
                    fontSize:'0.75rem',
                    letterSpacing:'0.04em',
                    color:C.navy,
                    textDecoration:'none',
                    transition:'padding-left 0.22s cubic-bezier(0.34,1.56,0.64,1), color 0.18s ease',
                  }
                },
                  // Small colored dot
                  React.createElement('div',{style:{
                    width:6,height:6,borderRadius:'50%',
                    background:hovMember===mi?g.color:'#D4CEC9',
                    flexShrink:0,
                    transition:'background 0.18s ease',
                  }}),
                  m.name,
                  // Arrow icon on hover
                  React.createElement('svg',{
                    xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",
                    strokeWidth:1.5,stroke:"currentColor",
                    width:12,height:12,
                    style:{marginLeft:'auto',opacity:hovMember===mi?0.6:0,transition:'opacity 0.18s ease'}
                  },
                    React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})
                  )
                )
              )
            )
          : React.createElement('p',{style:{
              fontFamily:"'DM Mono',monospace",fontSize:'0.7rem',
              color:C.navy,opacity:0.4,fontStyle:'italic',
            }},'No members data available.'),
      ),

      /* ⑥ CONTACT FORM — only for gen-comm */
      isContact && React.createElement('div',{
        style:{width:'100%',marginTop:28,animation:'contentIn 0.5s ease 0.44s both'}
      },
        // Section label
        React.createElement('p',{style:{
          fontFamily:"'DM Mono',monospace",fontSize:'0.52rem',
          letterSpacing:'0.22em',textTransform:'uppercase',
          color:C.navy,opacity:0.38,marginBottom:14,
          paddingBottom:8,borderBottom:'1px solid #EDE8E5',
        }},'Send a Message'),

        sent
          // ── Success state ──
          ? React.createElement('div',{style:{
              padding:'18px 20px',borderRadius:6,
              background:'#F0F7F4',
              border:`1.5px solid ${g.color}`,
              display:'flex',alignItems:'center',gap:12,
              fontFamily:"'DM Mono',monospace",fontSize:'0.72rem',
              color:C.navy,
            }},
              React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:g.color,width:18,height:18,style:{flexShrink:0}},
                React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})
              ),
              'Message sent successfully!'
            )
          // ── Form ──
          : React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:12}},

              // Name
              React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:5}},
                React.createElement('label',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.5rem',letterSpacing:'0.16em',textTransform:'uppercase',color:C.navy,opacity:0.45}},'Full Name'),
                React.createElement('input',{
                  type:'text',value:form.name,placeholder:'Your name',
                  onChange:e=>setForm(f=>({...f,name:e.target.value})),
                  style:{padding:'10px 14px',border:'1.5px solid #E5E0DD',borderRadius:4,fontFamily:"'DM Mono',monospace",fontSize:'0.75rem',color:C.navy,outline:'none',background:'#FAFAF9',transition:'border-color 0.2s',},
                  onFocus:e=>e.target.style.borderColor=g.color,
                  onBlur:e=>e.target.style.borderColor='#E5E0DD',
                })
              ),

              // Email
              React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:5}},
                React.createElement('label',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.5rem',letterSpacing:'0.16em',textTransform:'uppercase',color:C.navy,opacity:0.45}},'Email'),
                React.createElement('input',{
                  type:'email',value:form.email,placeholder:'your@email.com',
                  onChange:e=>setForm(f=>({...f,email:e.target.value})),
                  style:{padding:'10px 14px',border:'1.5px solid #E5E0DD',borderRadius:4,fontFamily:"'DM Mono',monospace",fontSize:'0.75rem',color:C.navy,outline:'none',background:'#FAFAF9',transition:'border-color 0.2s',},
                  onFocus:e=>e.target.style.borderColor=g.color,
                  onBlur:e=>e.target.style.borderColor='#E5E0DD',
                })
              ),

              // Message
              React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:5}},
                React.createElement('label',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.5rem',letterSpacing:'0.16em',textTransform:'uppercase',color:C.navy,opacity:0.45}},'Message'),
                React.createElement('textarea',{
                  value:form.message,placeholder:'Write your message here...',rows:5,
                  onChange:e=>setForm(f=>({...f,message:e.target.value})),
                  style:{padding:'10px 14px',border:'1.5px solid #E5E0DD',borderRadius:4,fontFamily:"'DM Mono',monospace",fontSize:'0.75rem',color:C.navy,outline:'none',background:'#FAFAF9',resize:'vertical',transition:'border-color 0.2s',},
                  onFocus:e=>e.target.style.borderColor=g.color,
                  onBlur:e=>e.target.style.borderColor='#E5E0DD',
                })
              ),

              // Error message
              formErr && React.createElement('p',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.65rem',color:'#BF512C',margin:0}},formErr),

              // Send button
              React.createElement('button',{
                onClick:handleSend,
                disabled:sending,
                style:{
                  marginTop:4,padding:'12px 24px',
                  background:sending?'#ccc':g.color,
                  color:g.text,border:'none',borderRadius:4,cursor:sending?'not-allowed':'pointer',
                  fontFamily:"'DM Mono',monospace",fontSize:'0.6rem',
                  letterSpacing:'0.18em',textTransform:'uppercase',
                  alignSelf:'flex-start',
                  transition:'transform 0.2s, box-shadow 0.2s, background 0.2s',
                },
                onMouseEnter:e=>{ if(!sending){ e.currentTarget.style.transform='scale(1.04)'; e.currentTarget.style.boxShadow=`0 8px 24px -6px ${g.color}99`; }},
                onMouseLeave:e=>{ e.currentTarget.style.transform='scale(1)'; e.currentTarget.style.boxShadow='none'; },
              }, sending ? 'Sending...' : 'Send Message →')
            )
      )
    )
  );
}

/* ══════════════════════════════════════════════════════════
   ZOOM CONTROL
══════════════════════════════════════════════════════════ */
function ZoomControl({zoom,setZoom,hidden}){
  const dragRef=useRef({on:false,startY:0,startZ:1});

  const onDown=useCallback((e)=>{
    e.preventDefault();
    dragRef.current={on:true,startY:e.clientY,startZ:zoom};
    const mv=ev=>{
      if(!dragRef.current.on)return;
      const dy=dragRef.current.startY-ev.clientY;
      setZoom(z=>Math.max(0.5,Math.min(2.5,dragRef.current.startZ+dy/200)));
    };
    const up=()=>{ dragRef.current.on=false; window.removeEventListener('pointermove',mv); };
    window.addEventListener('pointermove',mv);
    window.addEventListener('pointerup',up,{once:true});
  },[zoom,setZoom]);

  const pct=((zoom-0.5)/(2.5-0.5))*100;

  return React.createElement('div',{style:{
    position:'fixed',bottom:36,right:44,zIndex:150,
    display:'flex',flexDirection:'column',alignItems:'center',gap:8,
    opacity:hidden?0:1,
    pointerEvents:hidden?'none':'auto',
    transition:'opacity 0.3s ease',
    userSelect:'none',
  }},
    React.createElement('span',{style:{fontFamily:"'DM Mono'",fontSize:'0.48rem',letterSpacing:'0.2em',textTransform:'uppercase',color:C.navy,opacity:0.38}},'zoom'),
    React.createElement('div',{
      onPointerDown:onDown,
      style:{width:3,height:84,background:'#E8E3E0',borderRadius:2,position:'relative',cursor:'ns-resize'}
    },
      React.createElement('div',{style:{
        position:'absolute',left:'50%',
        transform:'translateX(-50%)',
        bottom:`${pct}%`,
        width:13,height:13,borderRadius:'50%',
        background:C.navy,pointerEvents:'none',
        transition:'bottom 0.08s',
      }})
    ),
    React.createElement('div',{style:{display:'flex',flexDirection:'column',alignItems:'center',gap:0}},
      React.createElement('button',{onClick:()=>setZoom(z=>Math.min(2.5,+(z+0.1).toFixed(2))),
        style:{background:'none',border:'none',cursor:'pointer',color:C.navy,opacity:0.4,fontSize:17,lineHeight:1,padding:'3px 6px',fontFamily:"'DM Mono'",transition:'opacity 0.2s'},
        onMouseEnter:e=>e.currentTarget.style.opacity=1,
        onMouseLeave:e=>e.currentTarget.style.opacity=0.4,
      },'+'),
      React.createElement('button',{onClick:()=>setZoom(z=>Math.max(0.5,+(z-0.1).toFixed(2))),
        style:{background:'none',border:'none',cursor:'pointer',color:C.navy,opacity:0.4,fontSize:17,lineHeight:1,padding:'3px 6px',fontFamily:"'DM Mono'",transition:'opacity 0.2s'},
        onMouseEnter:e=>e.currentTarget.style.opacity=1,
        onMouseLeave:e=>e.currentTarget.style.opacity=0.4,
      },'−')
    )
  );
}

/* ══════════════════════════════════════════════════════════
   APP ROOT
══════════════════════════════════════════════════════════ */
function App(){
  const [wh,setWh]=useState({w:window.innerWidth,h:window.innerHeight});
  const [nodes,setNodes]=useState([]);
  const [selected,setSelected]=useState(null);
  const [hovered,setHovered]=useState(null);
  // ↑ CHANGE 2: start at 0.68 (zoomed-out overview), let user zoom in
  const [zoom,setZoom]=useState(1.2);
  const [panelKey,setPanelKey]=useState(0);
  const hasSel=!!selected;

  useEffect(()=>{
    const fn=()=>{ setWh({w:window.innerWidth,h:window.innerHeight}); setSelected(null); };
    window.addEventListener('resize',fn);
    return()=>window.removeEventListener('resize',fn);
  },[]);

  useEffect(()=>{
    const ns=runSim(RAW.map(n=>({...n})),wh.w,wh.h);
    setNodes(ns);
  },[wh]);

  // Wheel zoom
  useEffect(()=>{
    const fn=e=>{ e.preventDefault(); setZoom(z=>Math.max(0.5,Math.min(2.5,z-e.deltaY/550))); };
    window.addEventListener('wheel',fn,{passive:false});
    return()=>window.removeEventListener('wheel',fn);
  },[]);

  const handleSelect=useCallback((node)=>{
    setSelected(node);
    setPanelKey(k=>k+1);
  },[]);

  const handleBack=useCallback(()=>{
    setSelected(null);
  },[]);

  const panelW=Math.min(490,wh.w*0.88);
  // When panel is open, shift stage left to give breathing room
  const stageShift=hasSel ? -panelW*0.28 : 0;

  return React.createElement('div',{style:{
    position:'fixed',inset:0,background:C.bg,overflow:'hidden',
  }},
    /* ── Zoomable stage ── */
    React.createElement('div',{style:{
      position:'absolute',inset:0,
      transform:`scale(${zoom}) translateX(${stageShift/zoom}px)`,
      transformOrigin:'center center',
      transition:'transform 0.55s cubic-bezier(0.22,1,0.36,1)',
      willChange:'transform',
    }},
      nodes.map((n,i)=>React.createElement(NodeCircle,{
        key:n.id,node:n,
        g:GROUPS[n.group],
        idx:i,
        selected,hovered,
        setHovered,
        setSelected:handleSelect,
      }))
    ),

    /* ── Header ── */
    React.createElement('div',{style:{
      position:'fixed',top:0,left:0,right:0,zIndex:200,
      display:'flex',alignItems:'center',justifyContent:'space-between',
      padding:'24px 44px',
      opacity:hasSel?0:1,
      transform:hasSel?'translateY(-14px)':'translateY(0)',
      transition:'all 0.35s ease',
      pointerEvents:hasSel?'none':'auto',
    }},
    React.createElement('img',{src:'Maktek_logo.png',alt:'Maktek',style:{height:80,width:'auto',objectFit:'contain',display:'block'}}),
      React.createElement('span',{style:{fontFamily:"'DM Mono',monospace",fontSize:'0.57rem',letterSpacing:'0.22em',textTransform:'uppercase',color:C.navy,opacity:0.38}},
        `${RAW.length} Topics`
      )
    ),

    /* ── Legend ── */
    React.createElement('div',{style:{
      position:'fixed',bottom:36,left:44,zIndex:150,
      display:'flex',flexDirection:'column',gap:6,
      opacity:hasSel?0:1,
      transition:'opacity 0.3s ease',
      pointerEvents:'none',
    }},
      Object.entries(GROUPS).map(([k,g])=>
        React.createElement('div',{key:k,style:{display:'flex',alignItems:'center',gap:8}},
          React.createElement('div',{style:{
            width:8,height:8,borderRadius:'50%',background:g.color,
            border:k==='general'?`1.5px solid ${C.navy}`:'none',flexShrink:0,
          }}),
          React.createElement('span',{style:{
            fontFamily:"'DM Mono',monospace",fontSize:'0.51rem',
            letterSpacing:'0.18em',textTransform:'uppercase',
            color:C.navy,opacity:0.48,
          }},g.label)
        )
      )
    ),

    /* ── Zoom Control ── */
    React.createElement(ZoomControl,{zoom,setZoom,hidden:hasSel}),

    /* ── Tooltip ── */
    hovered&&!hasSel&&React.createElement(Tooltip,{
      node:hovered,nodes,zoom,
      shiftX:stageShift*zoom,
    }),

    /* ── Panel ── */
    hasSel&&React.createElement(Panel,{
      key:panelKey,
      node:selected,
      panelW,
      onBack:handleBack,
    })
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
</script>
</body>
</html>